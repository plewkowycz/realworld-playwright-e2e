# E2E Test Runner for Playwright
# Usage:
#   1. Start the app first: docker compose -f app/docker-compose.yml up -d
#   2. Run tests: docker compose run --rm tests
#   3. Stop app: docker compose -f app/docker-compose.yml down -v

services:
  tests:
    image: mcr.microsoft.com/playwright:v1.57.0-jammy
    working_dir: /work
    volumes:
      - .:/work
      - ./test-results:/work/test-results
      - ./playwright-report:/work/playwright-report
    environment:
      - APP_BASE_URL=http://localhost:4200
      - APP_API_URL=http://localhost:8000
    # Use host network to access app running on localhost
    network_mode: host
    # Recommended flags for Playwright in Docker
    ipc: host
    init: true
    command: >
      bash -lc "
      npm ci &&
      npx playwright test --reporter=list,html
      "
